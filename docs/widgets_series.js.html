

<!DOCTYPE html>
<html lang="en">

<head>
  
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Devo Applications Builder widgets/series.js</title>

  <script src="https://cdn.jsdelivr.net/gh/google/code-prettify@master/loader/run_prettify.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="./build/entry.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->
  <link href="https://fonts.googleapis.com/css?family=Roboto:100,400,700|Inconsolata,700" rel="stylesheet">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
  <link type="text/css" rel="stylesheet" href="https://jmblog.github.io/color-themes-for-google-code-prettify/themes/tomorrow-night.min.css">
  <link type="text/css" rel="stylesheet" href="styles/app.min.css">
  <link type="text/css" rel="stylesheet" href="styles/iframe.css">
  <link type="text/css" rel="stylesheet" href="">
  <script async defer src="https://buttons.github.io/buttons.js"></script>

  
</head>



<body class="layout small-header">
    <div id="stickyNavbarOverlay"></div>
    

<div class="top-nav">
    <div class="inner">
        <a id="hamburger" role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
            <span aria-hidden="true"></span>
            <span aria-hidden="true"></span>
            <span aria-hidden="true"></span>
        </a>
        <div class="logo">
            
             
                <a href="index.html">
                    <h1 class="navbar-item">Devo Applications Builder</h1>
                </a>
            
        </div>
        <div class="menu">
            
            <div class="navigation">
                <a
                    href="index.html"
                    class="link"
                >
                    Documentation
                </a>
                
                <div class="dropdown is-hoverable is-right">
                    <a class="dropdown-trigger link">
                        Tutorials
                        <i class="fas fa-chevron-down fa-xs"></i>
                    </a>
                    <div class="dropdown-menu">
                        <div class="dropdown-content">
                        
                            <a class="dropdown-item" href="tutorial-basics.html">
                                Getting started
                            </a>
                        
                            <a class="dropdown-item" href="tutorial-configurations.html">
                                Advanced
                            </a>
                        
                            <a class="dropdown-item" href="tutorial-widgets.html">
                                Widgets
                            </a>
                        
                        </div>
                    </div>
                </div>
                
                 
                    
                        <a
                            class="link user-link "
                            href="https://github.com/DevoInc/applications-builder"
                        >
                            Github
                        </a>
                    
                        <a
                            class="link user-link "
                            href="https://github.com/DevoInc/applications-builder-template"
                        >
                            Example Application
                        </a>
                    
                
                
            </div>
        </div>
    </div>
</div>
    <div id="main">
        <div
            class="sidebar "
            id="sidebarNav"
        >
            
                <div class="search-wrapper">
                    <input id="search" type="text" placeholder="Search docs..." class="input">
                </div>
            
            <nav>
                
                    <h2><a href="index.html">Documentation</a></h2><div class="category"><h3>Classes</h3><ul><li><a href="App.html">App</a></li><li><a href="I18n.html">I18n</a></li><li><a href="Section.html">Section</a></li><li><a href="Settings.html">Settings</a></li><li><a href="Tab.html">Tab</a></li><li><a href="TabsBar.html">TabsBar</a></li></ul></div><div class="category"><h2>Data</h2><h3>Classes</h3><ul><li><a href="DataNode.html">DataNode</a></li><li><a href="DataTree.html">DataTree</a></li><li><a href="Dependencies.html">Dependencies</a></li><li><a href="Requests.html">Requests</a></li></ul></div><div class="category"><h2>Fields</h2><h3>Classes</h3><ul><li><a href="BaseField.html">BaseField</a></li><li><a href="Button.html">Button</a></li><li><a href="CheckBoxField.html">CheckBoxField</a></li><li><a href="ChoicePickerField.html">ChoicePickerField</a></li><li><a href="DateTimePickerField.html">DateTimePickerField</a></li><li><a href="DateTimePickerRangeField.html">DateTimePickerRangeField</a></li><li><a href="DateTimePickerRangeFieldPresets.html">DateTimePickerRangeFieldPresets</a></li><li><a href="InputField.html">InputField</a></li><li><a href="Select2Field.html">Select2Field</a></li><li><a href="SelectField.html">SelectField</a></li></ul><h3>Global</h3><ul><li><a href="global.html#matchElement">matchElement</a></li></ul></div><div class="category"><h2>Libs</h2><h3>Modules</h3><ul><li><a href="module-alerts.html">alerts</a></li><li><a href="module-D3Bullet.html">D3Bullet</a></li><li><a href="module-dom.html">dom</a></li><li><a href="module-downloads.html">downloads</a></li><li><a href="module-events.html">events</a></li><li><a href="module-user.html">user</a></li><li><a href="module-zoomChart.html">zoomChart</a></li></ul><h3>Classes</h3><ul><li><a href="ScreenShot.html">ScreenShot</a></li></ul><h3>Global</h3><ul><li><a href="global.html#takeElementScreenShot">takeElementScreenShot</a></li></ul></div><div class="category"><h2>Utils</h2><h3>Modules / Bootstrap</h3><ul><li><a href="module-bootstrap.html">bootstrap</a></li></ul><h3>Modules / Global</h3><ul><li><a href="module-casting.html">casting</a></li><li><a href="module-dateRange.html">dateRange</a></li><li><a href="module-dates.html">dates</a></li><li><a href="module-intervals.html">intervals</a></li><li><a href="module-objects.html">objects</a></li><li><a href="module-order.html">order</a></li><li><a href="module-Query%2520Utils.html">Query Utils</a></li><li><a href="module-scroll.html">scroll</a></li><li><a href="module-units.html">units</a></li></ul><h3>Modules / Helpers</h3><ul><li><a href="module-Helper%2520Highcharts.html">Helper Highcharts</a></li><li><a href="module-Helper%2520Renderers.html">Helper Renderers</a></li></ul><h3>Classes / Bootstrap</h3><ul><li><a href="FullScreenShotBtn.html">FullScreenShotBtn</a></li><li><a href="TvBtn.html">TvBtn</a></li></ul><h3>Classes / Helpers</h3><ul><li><a href="Monitoring.html">Monitoring</a></li></ul></div><div class="category"><h2>Widgets</h2><h3>Modules</h3><ul><li><a href="module-AnimatedHeatmap.html">AnimatedHeatmap</a></li><li><a href="module-Area.html">Area</a></li><li><a href="module-AvailabilityTimeline.html">AvailabilityTimeline</a></li><li><a href="module-Bichord.html">Bichord</a></li><li><a href="module-Bubbles.html">Bubbles</a></li><li><a href="module-Bullet.html">Bullet</a></li><li><a href="module-CircleWorldMap.html">CircleWorldMap</a></li><li><a href="module-Column.html">Column</a></li><li><a href="module-Empty.html">Empty</a></li><li><a href="module-Funnel.html">Funnel</a></li><li><a href="module-Gauge.html">Gauge</a></li><li><a href="module-GoogleColormap.html">GoogleColormap</a></li><li><a href="module-GoogleHeatmap.html">GoogleHeatmap</a></li><li><a href="module-Graph.html">Graph</a></li><li><a href="module-HeatCalendar.html">HeatCalendar</a></li><li><a href="module-Histogram.html">Histogram</a></li><li><a href="module-Lines.html">Lines</a></li><li><a href="module-Monitoring.html">Monitoring</a></li><li><a href="module-PewPewMap.html">PewPewMap</a></li><li><a href="module-Pie.html">Pie</a></li><li><a href="module-PieLayered.html">PieLayered</a></li><li><a href="module-Punchcard.html">Punchcard</a></li><li><a href="module-RAG.html">RAG</a></li><li><a href="module-Sankey.html">Sankey</a></li><li><a href="module-Series.html">Series</a></li><li><a href="module-StackedBars.html">StackedBars</a></li><li><a href="module-Table.html">Table</a></li><li><a href="module-TimeHeatmap.html">TimeHeatmap</a></li><li><a href="module-Tree.html">Tree</a></li><li><a href="module-Voronoi.html">Voronoi</a></li></ul><h3>Modules / Mixins</h3><ul><li><a href="module-base.html">base</a></li><li><a href="module-collapser.html">collapser</a></li><li><a href="module-dataSearch.html">dataSearch</a></li><li><a href="module-download.html">download</a></li><li><a href="module-info.html">info</a></li><li><a href="module-lifeCycle.html">lifeCycle</a></li><li><a href="module-listeners.html">listeners</a></li><li><a href="module-loading.html">loading</a></li><li><a href="module-menu.html">menu</a></li><li><a href="module-screenshot.html">screenshot</a></li><li><a href="module-showQuery.html">showQuery</a></li><li><a href="module-zoom.html">zoom</a></li></ul></div>
                
            </nav>
        </div>
        <div class="core" id="main-content-wrapper">
            <div class="content">
                <header class="page-title">
                    <p>Source</p>
                    <h1>widgets/series.js</h1>
                </header>
                



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import processStructure from '@devoinc/applications-data-library/structures/series';
import objects from '@devoinc/applications-builder/utils/objects';
import highchartsHelper from './helpers/highchartsHelper';
import downloads from '@devoinc/applications-builder/libs/downloads';
import HCP from '@devoinc/applications-builder/widgets/helpers/exportDataSeries';
import { __ } from '@devoinc/applications-builder/i18n';
import widgetFactory from '@devoinc/applications-builder/widgetFactory';
import dependencies from '../data/dependencies';

const LineWidget = dependencies.require('widgets').LineWidget;

/**
 * Here all the methods of the widgets based on the
 * [Highchart]{@link https://www.highcharts.com/} library are available.
 * Most of them are widgets based on the representation of temporal data.
 *
 * The list of widgets that use these same methods is:
 * - [Area](module-area.html)
 * - [Column](module-column.html)
 * - [Histogram](module-histogram.html)
 * - [Lines](module-lines.html)
 * - [Stacked Bars](module-stacked-bars.html)
 *
 * @category Widgets
 * @module Series
 * @see [base](module-base.html)
 * @see [collapser](module-collapser.html)
 * @see [dataSearch](module-dataSearch.html)
 * @see [download](module-download.html)
 * @see [info](module-info.html)
 * @see [lifeCycle](module-lifeCycle.html)
 * @see [listeners](module-listeners.html)
 * @see [loading](module-loading.html)
 * @see [menu](module-menu.html)
 * @see [screenshot](module-screenshot.html)
 * @see [zoom](module-zoom.html)
 */
export function mixin(self) {
  HCP.highcharts();

  return {
    /**
     * Set the keys to show.
     * @param {string[]} key - Keys name.
     * @instance
     */
    setKeys(key) {
      self.settings.keyToShow = key;
    },

    /**
     * Set series names to display.
     * @param {string[]} series - Series names.
     * @instance
     */
    setSeriesNames(series) {
      self.settings.seriesNames = series;
    },

    /**
     * Set the column with timespamp key.
     * @param {string} tsKey - Timestamp column name.
     * @instance
     */
    setTimestampKey(tsKey) {
      self.settings.timestampKey = tsKey;
    },

    /**
     * Set the value to show.
     * @param {string} val - Column name with the value.
     * @instance
     */
    setValue(val) {
      self.settings.valToShow = val;
    },

    /**
     * Set the data grouping.
     *
     * It accepts the moment's get values:
     * - &lt;b>date&lt;/b>
     * - &lt;b>year&lt;/b>
     * - &lt;b>month&lt;/b>
     * - &lt;b>day&lt;/b>
     * - &lt;b>hour&lt;/b>
     * - &lt;b>minute'&lt;/b>
     * - &lt;b>second&lt;/b>
     * - &lt;b>millisecond&lt;/b>
     * @param {string} grouping - Data grouping.
     * @instance
     */
    setGrouped(grouping) {
      self.settings.groupped = grouping;
    },

    /**
     * Set the Y axis title.
     * @param {string} title - Title text.
     * @instance
     */
    setYAxisTitle(title) {
      self.settings.yaxis_title = title;
    },

    /**
     * Set the X axis title.
     * @param {string} title - Title text.
     * @instance
     */
    setXAxisTitle(title) {
      self.settings.xaxis_title = title;
    },

    /**
     * Fix the data, if it is true data can not be temporarily grouped
     * @param {boolean} bool - Fix the data.
     * @instance
     */
    setFixedData(bool) {
      self.settings.fixData = bool;
    },

    /**
     * Set decimal and thuousands separator.
     *
     * For example: &lt;i>"##,###,###.00"&lt;/i>
     * @param {string} str - Format string.
     * @instance
     */
    setFormat(str) {
      self.settings.format = str;
    },

    /**
     * Set the legend visible.
     * @param {boolean} bool - Enable the legend.
     * @instance
     */
    setLegend(bool) {
      self.settings.legend = bool;
    },

    /**
     * Set the defautl widget legend format.
     *
     * The asigned function receives an object with &lt;i>color&lt;/i> and
     * &lt;i>name&lt;/i> values.
     * @param {Function} func - Function to set default legend format.
     * @instance
     */
    setDefaultFormaterLegend(func) {
      self.settings.defaultformaterlegend = func;
    },

    /**
     * Set the default tooltip format.
     *
     * The asigned function receives an object with &lt;i>x&lt;/i> and
     * &lt;i>y&lt;/i> values.
     * @param {Function} func - Function to set default tooltip format.
     * @instance
     */
    setDefaultFormater(func) {
      self.settings.defaultformater = func;
    },

    /**
     * Set data accumulation, sum a value with the previous value.
     * @param {boolean} bool - Enable the data accumulation.
     * @instance
     */
    setAccumulated(bool) {
      self.settings.accumulated = bool;
    },

    /**
     * Show an average line.
     * @param {boolean} bool - Enable the average line.
     * @instance
     */
    setShowAvgLine(bool) {
      self.settings.showAvgLine = bool;
    },

    /**
     * Discard values using a determined method.
     *
     * The following values are supported:
     * - &lt;b>none&lt;/b>: Do not apply.
     * - &lt;b>stdDev&lt;/b>: Discard values using standard deviation.
     * @param {String} str - Method to use.
     * @instance
     */
    setDiscardMethod(str) {
      self.settings.discardMethod = str;
    },

    /**
     * Discard values using a determined mode.
     *
     * The following values are supported:
     * - &lt;b>plotBand&lt;/b>
     * - &lt;b>extremes&lt;/b>
     * @param {string} str - Mode to use.
     * @instance
     */
    setDiscardMode(str) {
      self.settings.discardMode = str;
    },

    /**
     * Allows add regression series in the chart.
     * This function sets &lt;i>fixData&lt;/i> to &lt;i>false&lt;/i> as a requirement
     * to display a regression line.
     *
     * The following values are supported:
     * - &lt;b>none&lt;/b>
     * - &lt;b>linear&lt;/b>
     * - &lt;b>exponential&lt;/b>
     * - &lt;b>polynomial&lt;/b>
     * - &lt;b>logarithmic&lt;/b>
     * - &lt;b>loess&lt;/b>
     * @param {string} str - Regression type.
     * @instance
     */
    setRegressionLine(str) {
      self.settings.regressionLine = str;
      self.settings.fixData = false;
    },

    /**
     * Set the Y axis scale.
     *
     * The following values are supported:
     * - &lt;b>none&lt;/b>
     * - &lt;b>logarithmic&lt;/b>
     * @param {string} str - Scale type.
     * @instance
     */
    setYscaleType(str) {
      self.settings.yScaleType = str;
    },

    /**
     * Highlights max and min values.
     * @param {boolean} bool - Enbale the highlights.
     * @instance
     */
    setHighlightMaxMin(bool) {
      self.settings.highlightMaxMin = bool;
    },

    /**
     * Set the label formatter for the Y axis.
     * @param {Function} func - Callback JavaScript function to format the label.
     * @instance
     */
    setYAxisLabelsFormatter(func) {
      objects.set(self.settings, 'widgetTemplate.yAxis.labels.formatter', func);
    },

    /**
     * Set the label formatter for the X axis.
     * @param {Function} func -Callback JavaScript function to format the label.
     * @instance
     */
    setXAxisFormatter(func) {
      objects.set(self.settings, 'widgetTemplate.xAxis.labels.formatter', func);
    },

    /**
     * Set the widget start to first element.
     * @param {Boolean} bool - Enable to start with the first element.
     * @instance
     */
    setForceFirstElement(bool) {
      self.settings.forceFirstElement = bool;
    },

    /**
     * Set the widget end to last element.
     * @param {Boolean} bool - Enable to start with the first element.
     * @instance
     */
    setForceLastElement(bool) {
      self.settings.forceLastElement = bool;
    },

    /**
     * Set the allKeysLimit
     * Note: This is not used
     * @param {number} [limit=15] - Limit
     * @ignore
     */
    setAllKeysLimit(limit = 20) {
      self.settings.allKeysLimit = limit;
    },

    /**
     * Set the format of the x axis labels.
     *
     * Avaiable formats are:
     * {@link https://api.highcharts.com/highcharts/xAxis.dateTimeLabelFormats}
     * @param {Object} obj - Check the Highcharts documentation.
     * @instance
     */
    setDateTimeLabelFormats(obj) {
      objects.set(
        self.settings,
        'widgetTemplate.xAxis.dateTimeLabelFormats',
        obj
      );
    },

    /**
     * An array determining what time intervals the ticks are allowed to fall
     * on.
     * {@link https://api.highcharts.com/highcharts/xAxis.units}
     * @param {Array} arr - Check the Highcharts documentation.
     * @instance
     */
    setXAxisUnits(arr) {
      objects.set(self.settings, 'widgetTemplate.xAxis.units', arr);
    },

    /**
     * Set YAxis and values to the bytes format
     * @instance
     */
    setToBytes() {
      objects.set(
        self.settings,
        'widgetTemplate.yAxis.labels.formatter',
        highchartsHelper.axisFormatterByteSize(1, true)
      );
      objects.set(
        self.settings,
        'defaultformater',
        highchartsHelper.valueFormatterByteSize()
      );
    },

    /**
     * Set any settings to the widget.
     * For highchart properties use &lt;i>'widgetTemplate'&lt;/i> as the base of the path.
     * @param {string} path - Path to the settings.
     * @param {*} val - Value to set.
     * @instance
     */
    setProperty(path, val) {
      objects.set(self.settings, path, val);
    },

    /**
     * Set the rest of series to a new grouped series called _other_.
     * @param {boolean} [bool=false] - Show grouped series.
     * @instance
     */
    setOthers(bool = false) {
      self.settings.others = bool;
    },

    /**
     * Set the number of series to be displayed.
     * @param {number} [num=10] - Number of series.
     * @instance
     */
    setTop(num = 10) {
      self.settings.top = num;
    },

    /**
     * Set the aggrupation for the data to add zeros.
     * @param {string | Function} string - Text with a unit of time of
     * &lt;i>moment.js&lt;/i> library or a function that recive a object with
     * &lt;i>from&lt;/i> and &lt;i>to&lt;/i> key date.
     * @instance
     */
    setGrouping(str = 'days') {
      self.settings.grouping = str;
    },

    /**
     * Set the order type for the series.
     *
     * The following values are supported:
     * - &lt;b>alphabetic&lt;/b>
     * - &lt;b>total&lt;/b>
     * - Or a function
     * @param {string|Function} val - Text with the order type or a
     * function to order the series.
     * @instance
     */
    setSeriesOrder(val = 'alphabetic') {
      self.settings.seriesOrder = val;
    },

    /**
     * Set the parser function for the values.
     * @param {Function} func - The parser function.
     * @instance
     */
    setValuesParseFunction(func) {
      self.settings.valuesParseFunction = func;
    },

    /**
     * Filter the series by a custom function or using a number
     * to limit the number of series to display.
     * @param {Function|number} func - Callback function or number to filter.
     * the series.
     * @instance
     */
    setSeriesFilter(func = null) {
      self.settings.seriesFilter = func;
    },

    /**
     * Set a custom property available in Highchart for the chart.
     * @param {Object[]} props - Array the properties.
     * @instance
     */
    setSeriesProperties(props) {
      self.settings.seriesProperties = props;
    },

    // Common
    // -------------------------------------------------------------------------

    /**
     * Download in CSV format
     * @ignore
     */
    downloadCSV() {
      let s = self.widget.chart.getCSV();
      downloads.downloadCSV(s, `${self.id}-data`);
    },

    /**
     * Redraw function
     * @ignore
     */
    redraw() {
      if (self.widget) {
        self.widget.chart.reflow();
      }
    },

    /**
     * Resize function
     * @ignore
     */
    resize() {
      this.redraw();
    },

    // Life Cycle
    // -------------------------------------------------------------------------

    /**
     * Render function
     * @param {object} orig - Data for process
     * @ignore
     */
    render(orig) {
      if (!self.el) return; // If not have element not render
      // let cfg = Object.assign({}, defaultSettings, self.settings);
      let cfg = self.settings;

      let data = processStructure(orig, {
        keys: cfg.keyToShow || [],
        values: cfg.valToShow || [],
        seriesNames: cfg.seriesNames || [],
        seriesProperties: cfg.seriesProperties || null,
        forceFirstElement:
          cfg.forceFirstElement == null ? true : cfg.forceFirstElement,
        forceLastElement:
          cfg.forceLastElement == null ? true : cfg.forceLastElement,
        timestampKey: cfg.timestampKey || 'eventdate',
        order: cfg.seriesOrder || null,
        filter: cfg.seriesFilter || null,
        parseFunc: cfg.valuesParseFunction || parseFloat,
        zeroFill: cfg.grouping,
      });

      objects.set(
        cfg,
        'widgetTemplate.chart.renderTo',
        self.el.querySelector('.lt-vapp-widget-graphic')
      );
      for (let item of data) item.name = __(item.name);

      if (data) {
        // Default formatter
        if (!cfg.defaultformater) {
          cfg.defaultformater = highchartsHelper.valueFormatterCount();
        }

        self.widget = new LineWidget(cfg);
        self.widget.setData(data);
        self.widget.display({ force: true, data: true });
      } else {
        this.debugError({
          msg: 'NO DATA',
          console: {
            method: 'error',
            msg: 'No data arrive to render function',
          },
        });
      }
    },
  };
}

export default widgetFactory(mixin);
</code></pre>
        </article>
    </section>




            </div>
            
            <footer class="footer">
                <div class="content has-text-centered">
                    <p>Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.11</a></p>
                    <p class="sidebar-created-by">
                        <a href="https://github.com/SoftwareBrothers/better-docs" target="_blank">BetterDocs theme</a> provided with <i class="fas fa-heart"></i> by
                        <a href="http://softwarebrothers.co" target="_blank">SoftwareBrothers - JavaScript Development Agency</a>
                    </p>
                </div>
            </footer>
            
        </div>
        <div id="side-nav" class="side-nav">
        </div>
    </div>
<script src="scripts/app.min.js"></script>
<script>PR.prettyPrint();</script>
<script src="scripts/linenumber.js"> </script>

<script src="scripts/search.js"> </script>


</body>
</html>
